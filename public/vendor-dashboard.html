<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vendor Dashboard - Square Dashboard Addon</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
      background-color: #f5f5f5;
      padding: 20px;
      line-height: 1.4;
    }
    .container {
      max-width: 1800px;
      margin: 0 auto;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    .header {
      background: #2563eb;
      color: white;
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 12px;
    }
    .header h1 { font-size: 24px; font-weight: 600; }
    .header-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    .back-button {
      background: rgba(255,255,255,0.2);
      color: white;
      padding: 8px 12px;
      border-radius: 6px;
      text-decoration: none;
      font-size: 13px;
      white-space: nowrap;
    }
    .back-button:hover { background: rgba(255,255,255,0.3); }
    @media (max-width: 600px) {
      .header {
        flex-direction: column;
        align-items: stretch;
        text-align: center;
      }
      .header h1 { font-size: 20px; }
      .header-buttons { justify-content: center; }
      .back-button { flex: 1; text-align: center; min-width: 80px; }
    }

    /* Summary cards */
    .stats-bar {
      background: #1f2937;
      color: white;
      padding: 15px 30px;
      display: flex;
      justify-content: space-around;
      flex-wrap: wrap;
      gap: 20px;
    }
    .stat { text-align: center; min-width: 100px; }
    .stat-number { font-size: 24px; font-weight: bold; color: #10b981; }
    .stat-number.alert { color: #ef4444; }
    .stat-label { font-size: 12px; color: #9ca3af; text-transform: uppercase; letter-spacing: 0.5px; margin-top: 4px; }

    /* Filter bar */
    .controls {
      padding: 15px 20px;
      border-bottom: 1px solid #e5e7eb;
      display: flex;
      gap: 10px;
      align-items: center;
      flex-wrap: wrap;
    }
    .filter-btn {
      padding: 8px 16px;
      border: 1px solid #d1d5db;
      border-radius: 6px;
      background: white;
      font-size: 14px;
      cursor: pointer;
      font-weight: 500;
      color: #374151;
    }
    .filter-btn.active {
      background: #2563eb;
      color: white;
      border-color: #2563eb;
    }
    .filter-btn:hover:not(.active) { background: #f3f4f6; }
    .controls select {
      padding: 8px 12px;
      border: 1px solid #d1d5db;
      border-radius: 4px;
      font-size: 14px;
      min-height: 38px;
      background: white;
      margin-left: auto;
    }
    .controls label { font-size: 13px; font-weight: 500; color: #6b7280; margin-left: auto; }

    /* Table */
    .table-container {
      overflow-x: auto;
    }
    table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      font-size: 14px;
    }
    th, td { padding: 12px; text-align: left; border-bottom: 1px solid #e5e7eb; }
    thead { position: sticky; top: 0; z-index: 100; }
    th {
      background: #f9fafb;
      font-weight: 600;
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      white-space: nowrap;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    tr.vendor-row { cursor: pointer; }
    tr.vendor-row:hover { background: #f9fafb; }

    /* Vendor cell */
    .vendor-name { font-weight: 600; color: #1f2937; }
    .vendor-items { font-size: 12px; color: #6b7280; }

    /* Status badges */
    .badge {
      display: inline-block;
      padding: 3px 10px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.3px;
      white-space: nowrap;
    }
    .badge-has_oos { background: #fee2e2; color: #991b1b; }
    .badge-below_min { background: #fef3c7; color: #92400e; }
    .badge-ready { background: #dbeafe; color: #1e40af; }
    .badge-needs_order { background: #f3f4f6; color: #374151; }
    .badge-ok { background: #d1fae5; color: #065f46; }

    /* Pill badges for counts */
    .pill {
      display: inline-block;
      padding: 2px 10px;
      border-radius: 10px;
      font-size: 13px;
      font-weight: 600;
    }
    .pill-red { background: #fee2e2; color: #991b1b; }
    .pill-yellow { background: #fef3c7; color: #92400e; }
    .pill-grey { background: #f3f4f6; color: #9ca3af; }

    /* Progress bar for PO vs Minimum */
    .po-progress { min-width: 120px; }
    .po-progress-text { font-size: 12px; color: #374151; margin-bottom: 3px; white-space: nowrap; }
    .po-progress-bar {
      height: 6px;
      background: #e5e7eb;
      border-radius: 3px;
      overflow: hidden;
    }
    .po-progress-fill {
      height: 100%;
      border-radius: 3px;
      transition: width 0.3s ease;
    }
    .po-progress-fill.met { background: #10b981; }
    .po-progress-fill.unmet { background: #f59e0b; }

    /* Last ordered coloring */
    .last-ordered-red { color: #ef4444; font-weight: 600; }
    .last-ordered-yellow { color: #f59e0b; font-weight: 600; }

    /* Payment method badges */
    .payment-badge {
      display: inline-block;
      padding: 3px 8px;
      border-radius: 4px;
      font-size: 11px;
      font-weight: 600;
      white-space: nowrap;
    }
    .payment-credit-card { background: #d1fae5; color: #065f46; }
    .payment-invoice { background: #dbeafe; color: #1e40af; }
    .payment-e-transfer { background: #ede9fe; color: #5b21b6; }
    .payment-cod { background: #fef3c7; color: #92400e; }
    .payment-na { background: #f3f4f6; color: #6b7280; }

    /* Expanded row */
    .expanded-row { display: none; }
    .expanded-row.visible { display: table-row; }
    .expanded-content {
      padding: 20px;
      background: #f9fafb;
      border-bottom: 2px solid #e5e7eb;
    }
    .detail-grid {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 20px;
      margin-bottom: 16px;
    }
    @media (max-width: 768px) {
      .detail-grid { grid-template-columns: 1fr; }
    }
    .detail-section h4 {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: #6b7280;
      margin-bottom: 10px;
      padding-bottom: 6px;
      border-bottom: 1px solid #e5e7eb;
    }
    .detail-row {
      display: flex;
      justify-content: space-between;
      padding: 4px 0;
      font-size: 13px;
    }
    .detail-label { color: #6b7280; }
    .detail-value { color: #1f2937; font-weight: 500; }
    .detail-notes {
      width: 100%;
      min-height: 60px;
      padding: 8px;
      border: 1px solid #d1d5db;
      border-radius: 4px;
      font-size: 13px;
      font-family: inherit;
      resize: vertical;
      background: white;
    }
    .detail-notes[readonly] {
      background: #f9fafb;
      border-color: #e5e7eb;
      resize: none;
    }
    .action-buttons {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      padding-top: 12px;
      border-top: 1px solid #e5e7eb;
    }
    .btn {
      padding: 8px 16px;
      border-radius: 4px;
      font-size: 13px;
      font-weight: 500;
      border: none;
      cursor: pointer;
      text-decoration: none;
      display: inline-block;
      line-height: 1.4;
    }
    .btn-primary { background: #1f2937; color: white; }
    .btn-primary:hover { background: #111827; }
    .btn-blue { background: #2563eb; color: white; }
    .btn-blue:hover { background: #1d4ed8; }
    .btn-secondary { background: #6b7280; color: white; }
    .btn-secondary:hover { background: #4b5563; }
    .btn-outline { background: white; color: #374151; border: 1px solid #d1d5db; }
    .btn-outline:hover { background: #f3f4f6; }
    .btn-green { background: #059669; color: white; }
    .btn-green:hover { background: #047857; }

    /* Edit mode */
    .edit-form { display: none; }
    .edit-form.visible { display: block; }
    .view-mode.hidden { display: none; }
    .edit-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 16px;
    }
    @media (max-width: 768px) {
      .edit-grid { grid-template-columns: 1fr; }
    }
    .form-group { display: flex; flex-direction: column; gap: 4px; }
    .form-group label { font-size: 12px; font-weight: 600; color: #374151; }
    .form-group input,
    .form-group select,
    .form-group textarea {
      padding: 8px 10px;
      border: 1px solid #d1d5db;
      border-radius: 4px;
      font-size: 13px;
      font-family: inherit;
    }
    .form-group textarea { resize: vertical; min-height: 60px; }
    .form-group .hint { font-size: 11px; color: #9ca3af; }
    .form-actions {
      display: flex;
      gap: 8px;
      padding-top: 12px;
      border-top: 1px solid #e5e7eb;
    }

    /* Loading & empty states */
    .loading { text-align: center; padding: 40px; color: #6b7280; }
    .empty { text-align: center; padding: 40px; color: #9ca3af; }

    /* Toast notification */
    .toast {
      position: fixed;
      bottom: 20px;
      right: 20px;
      padding: 12px 20px;
      border-radius: 6px;
      color: white;
      font-size: 14px;
      font-weight: 500;
      z-index: 9999;
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 0.3s, transform 0.3s;
    }
    .toast.visible { opacity: 1; transform: translateY(0); }
    .toast.success { background: #059669; }
    .toast.error { background: #dc2626; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>Vendor Dashboard</h1>
      <div class="header-buttons">
        <a href="reorder.html" class="back-button">Reorder Suggestions</a>
        <a href="purchase-orders.html" class="back-button">Purchase Orders</a>
        <a href="dashboard.html" class="back-button">Back to Dashboard</a>
      </div>
    </div>

    <!-- Summary Cards -->
    <div class="stats-bar">
      <div class="stat">
        <div class="stat-number" id="stat-oos">--</div>
        <div class="stat-label">Out of Stock</div>
      </div>
      <div class="stat">
        <div class="stat-number" id="stat-reorder">--</div>
        <div class="stat-label">Items to Reorder</div>
      </div>
      <div class="stat">
        <div class="stat-number" id="stat-po-value">--</div>
        <div class="stat-label">Pending PO Value</div>
      </div>
      <div class="stat">
        <div class="stat-number" id="stat-action">--</div>
        <div class="stat-label">Vendors Need Action</div>
      </div>
    </div>

    <!-- Filter Bar -->
    <div class="controls">
      <button class="filter-btn active" id="filter-all" data-action="setFilterAll">All (0)</button>
      <button class="filter-btn" id="filter-action" data-action="setFilterAction">Needs Action (0)</button>
      <label for="sort-select">Sort:</label>
      <select id="sort-select" data-change="sortVendors">
        <option value="status">Status</option>
        <option value="name">Name</option>
        <option value="last_ordered">Last Ordered</option>
      </select>
    </div>

    <!-- Vendor Table -->
    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>Vendor</th>
            <th>Status</th>
            <th>Schedule</th>
            <th>OOS</th>
            <th>Reorder</th>
            <th>Need vs Min</th>
            <th>Last Ordered</th>
            <th>Payment</th>
          </tr>
        </thead>
        <tbody id="vendor-tbody">
          <tr><td colspan="8" class="loading">Loading vendor data...</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <div id="toast" class="toast"></div>

  <script src="/js/event-delegation.js"></script>
  <!-- HTML escaping utility -->
  <script src="/js/utils/escape.js"></script>
  <script src="/js/vendor-dashboard.js"></script>
</body>
</html>
